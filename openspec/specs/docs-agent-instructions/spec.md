# docs-agent-instructions 规范

## 目的
定义生成的代理指令文档的编写标准，使模板、示例和验证清单清晰且可直接复制使用。

## 需求
### 需求：快速参考位置
AI 指令应当以快速参考部分开始，在任何叙述性指导之前呈现所需的文件结构、模板和格式规则。

#### 场景：在顶部加载模板
- **当** `openspec/AGENTS.md` 被重新生成或更新时
- **则** 标题后的第一个实质性部分应当为 `proposal.md`、`tasks.md`、规范增量和场景格式提供可直接复制的标题
- **且** 将每个模板链接到相应的工作流步骤以便深入阅读

### 需求：嵌入模板和示例
`openspec/AGENTS.md` 应当在代理进行相应编辑的位置包含完整的复制/粘贴模板和内联示例。

#### 场景：提供文件模板
- **当** 作者到达起草提案和增量的工作流指导时
- **则** 提供匹配所需结构的围栏式 Markdown 模板（`## Why`、`## ADDED Requirements`、`#### Scenario:` 等）
- **且** 为每个模板附上简短示例，展示正确的标题使用和场景要点

### 需求：预验证清单
`openspec/AGENTS.md` 应当提供简洁的预验证清单，在运行 `openspec validate` 之前突出显示常见的格式错误。

#### 场景：突出显示常见验证失败
- **当** 读者到达验证指导时
- **则** 呈现清单提醒他们验证需求标题、场景格式和增量部分
- **且** 包含至少关于 `#### Scenario:` 使用和场景前描述性需求文本的提醒

### 需求：渐进式工作流指导披露
文档应当将初学者必备知识与高级主题分开，使新手可以专注于核心步骤而不失去对高级工作流的访问。

#### 场景：组织初学者和高级部分
- **当** 重新组织 `openspec/AGENTS.md` 时
- **则** 保持介绍部分仅限于最少步骤（搭建、起草、验证、请求审查）
- **且** 将高级主题（多能力变更、归档详情、工具深入）移到明确标记的后续部分
- **且** 从快速参考提供到这些高级部分的锚点链接

### 需求：行为优先的规范编写指导
代理指令文档应当明确教导规范捕获可观察的行为契约，而实现细节属于设计/任务。

#### 场景：区分规范与实现内容
- **当** `openspec/AGENTS.md` 解释如何编写 `spec.md` 时
- **则** 它应当指导代理包含外部可验证的行为、输入/输出、错误和约束
- **且** 它应当指导代理避免在规范中包含内部库/框架选择和类/函数级实现细节

#### 场景：将细节路由到正确的产物
- **当** 需要实现细节时
- **则** 指令应当指导代理将其放在 `design.md` 或 `tasks.md` 中，而不是 `spec.md` 的行为需求部分

### 需求：默认轻量级指导
代理指令文档应当促进规范编写的最小仪式和适当严谨性。

#### 场景：应用渐进式严谨性
- **当** 代理为常规变更起草规范时
- **则** 指令应当倾向于简洁、轻量的需求和场景
- **且** 为更高风险的变更保留更深入、更完整的规范风格（如 API 破坏、迁移、跨团队或安全/隐私敏感工作）

#### 场景：清晰度时间优化
- **当** 指导讨论起草工作流时
- **则** 它应当强调产生仍可测试和可审查的最小规范
